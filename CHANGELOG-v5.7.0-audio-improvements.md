# ChildWatch v5.7.0 - Audio Quality & OpenStreetMap Improvements

**–î–∞—Ç–∞ –≤—ã–ø—É—Å–∫–∞:** 28 –æ–∫—Ç—è–±—Ä—è 2025

## üéâ –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### üéß **–£–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ—Å–ª—É—à–∫–∏**

#### 1. **–£–≤–µ–ª–∏—á–µ–Ω Jitter Buffer –¥–ª—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä —É–≤–µ–ª–∏—á–µ–Ω —Å 160–º—Å –¥–æ 240–º—Å
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä —É–≤–µ–ª–∏—á–µ–Ω —Å 1000–º—Å –¥–æ 1200–º—Å
- –ü–æ—Ä–æ–≥ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ —É–≤–µ–ª–∏—á–µ–Ω —Å 300–º—Å –¥–æ 400–º—Å
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∑–≤—É–∫–∞ –ø—Ä–∏ –ø–ª–æ—Ö–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏

#### 2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è WebSocket Reconnect**
- –£–º–µ–Ω—å—à–µ–Ω –Ω–∞—á–∞–ª—å–Ω—ã–π timeout –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å 20 –¥–æ 15 —Å–µ–∫—É–Ω–¥
- –£—Å–∫–æ—Ä–µ–Ω–∞ –ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Å 1—Å –¥–æ 0.5—Å)
- –£–≤–µ–ª–∏—á–µ–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ–≤—Ç–æ—Ä–∞ (—Å 5—Å –¥–æ 10—Å)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë—ã—Å—Ç—Ä–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∏ –æ–±—Ä—ã–≤–∞—Ö

### üó∫Ô∏è **OpenStreetMap Integration**

#### 3. **–ü–µ—Ä–µ—Ö–æ–¥ —Å Google Maps –Ω–∞ OpenStreetMap**
- –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –Ω–∞ OSMdroid
- –†–∞–±–æ—Ç–∞–µ—Ç **–ë–ï–ó VPN** –≤ –†–æ—Å—Å–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–∞—Ä—Ç—ã OpenStreetMap (Mapnik tiles)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏: –º–∞—Ä–∫–µ—Ä—ã, –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π, –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** –ö–∞—Ä—Ç–∞ —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö —Å —Å–∞–Ω–∫—Ü–∏—è–º–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### AudioPlaybackService.kt
- `JITTER_BUFFER_MIN_FRAMES`: 8 ‚Üí 12 (160ms ‚Üí 240ms)
- `JITTER_BUFFER_MAX_FRAMES`: 50 ‚Üí 60 (1s ‚Üí 1.2s)
- `JITTER_BUFFER_AGGRESSIVE_THRESHOLD`: 15 ‚Üí 20 (300ms ‚Üí 400ms)

### WebSocketClient.kt
- `CONNECTION_TIMEOUT`: 20000L ‚Üí 15000L
- `RECONNECTION_DELAY`: 1000L ‚Üí 500L
- `RECONNECTION_DELAY_MAX`: 5000L ‚Üí 10000L

### LocationMapActivity.kt
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –¥–ª—è OSMdroid
- –ó–∞–º–µ–Ω–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã: `com.google.android.gms.maps.*` ‚Üí `org.osmdroid.*`
- `GoogleMap` ‚Üí `MapView`
- `LatLng` ‚Üí `GeoPoint`
- `MarkerOptions` ‚Üí `Marker`
- –û–±—Ä–∞—Ç–Ω–∞—è –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∫–∞ (Geocoder) —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–î–æ–±–∞–≤–ª–µ–Ω–æ:** `org.osmdroid:osmdroid-android:6.1.18`
- **–î–æ–±–∞–≤–ª–µ–Ω–æ:** `androidx.preference:preference-ktx:1.2.1`
- **–£–¥–∞–ª–µ–Ω–æ:** `com.google.android.gms:play-services-maps:18.2.0`
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ:** `play-services-location:21.0.1` (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è)

### AndroidManifest.xml
- –î–æ–±–∞–≤–ª–µ–Ω–æ: `ACCESS_WIFI_STATE` (–¥–ª—è OSMdroid)
- –û–±–Ω–æ–≤–ª–µ–Ω–æ: `WRITE_EXTERNAL_STORAGE` (–¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–π–ª–æ–≤)

### Layout
- [activity_location_map_new.xml](app/src/main/res/layout/activity_location_map_new.xml:9-14):
  `<fragment>` (Google Maps) ‚Üí `<org.osmdroid.views.MapView>`

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ö–∞—á–µ—Å—Ç–≤–æ –∑–≤—É–∫–∞
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ –ø—Ä–∏ –ø–ª–æ—Ö–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
- ‚úÖ –ë–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–º –∫–∞–Ω–∞–ª–µ
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω—ã –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–∫–∞—Ö

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø—Ä–æ—Å–ª—É—à–∫–µ
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –ø–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (timeout 15s –≤–º–µ—Å—Ç–æ 20s)
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ–±—Ä—ã–≤–µ (0.5s –≤–º–µ—Å—Ç–æ 1s)
- ‚úÖ –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –ö–∞—Ä—Ç—ã
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –†–æ—Å—Å–∏–∏ –±–µ–∑ VPN
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–∞—Ä—Ç—ã
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å API –∫–ª—é—á–∞–º–∏
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–π–ª–æ–≤ –¥–ª—è –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ—Å–ª—É—à–∫–∞
- –ü–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å 2-3 –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏—è "–ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
  - **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å–∞ –¥–µ—Ç—Å–∫–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
  - **Workaround:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ –¥–µ—Ç—Å–∫–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ –≤–∫–ª—é—á–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥" –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º

### –ö–∞—Ä—Ç–∞
- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "18 —á. –Ω–∞–∑–∞–¥"
  - **–ü—Ä–∏—á–∏–Ω–∞:** –î–µ—Ç—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ –¥–∞–Ω–Ω—ã–µ (–≤—ã–∫–ª—é—á–µ–Ω–æ/–±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
  - **–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –¥–µ—Ç—Å–∫–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ

## üîÆ –ü–ª–∞–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –≤–µ—Ä—Å–∏—é (v5.8.0)

- [ ] Pre-connection check –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–æ—Å–ª—É—à–∫–∏
- [ ] –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å–∞ –¥–µ—Ç—Å–∫–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- [ ] –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞—Ç–∞—Ä–µ–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –∫–∞—Ä—Ç—ã

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ú–∏–≥—Ä–∞—Ü–∏—è Google Maps ‚Üí OSMdroid

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –ø–æ–¥ –¥—Ä—É–≥–∏–µ Activity —Å –∫–∞—Ä—Ç–∞–º–∏:

1. **build.gradle:** –ó–∞–º–µ–Ω–∏—Ç–µ `play-services-maps` –Ω–∞ `osmdroid-android`
2. **Layout XML:** –ó–∞–º–µ–Ω–∏—Ç–µ `<fragment>` –Ω–∞ `<org.osmdroid.views.MapView>`
3. **Kotlin –∫–æ–¥:**
   ```kotlin
   // Before (Google Maps)
   import com.google.android.gms.maps.*
   val position = LatLng(lat, lng)
   val marker = MarkerOptions().position(position)

   // After (OSMdroid)
   import org.osmdroid.*
   val position = GeoPoint(lat, lng)
   val marker = Marker(mapView).apply { this.position = position }
   ```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π –ø—Ä–æ—Å–ª—É—à–∫–∏:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–æ—Ö–æ–µ WiFi —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–ª–∏ 3G
2. –í–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –¥–µ—Ç—Å–∫–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ—Å–ª—É—à–∫—É –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º
4. –ü–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ—Å—å –º–µ–∂–¥—É WiFi/Mobile data
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –∑–≤—É–∫–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç—ã:**
1. –û—Ç–∫–ª—é—á–∏—Ç–µ VPN (–µ—Å–ª–∏ –±—ã–ª –≤–∫–ª—é—á–µ–Ω)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç—É –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–π–ª—ã OpenStreetMap –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫)

## ‚ú® –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- **OpenStreetMap contributors** –∑–∞ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç
- **osmdroid team** –∑–∞ –æ—Ç–ª–∏—á–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
- –°–æ–æ–±—â–µ—Å—Ç–≤—É –∑–∞ –±–∞–≥-—Ä–µ–ø–æ—Ä—Ç—ã –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –ø—Ä–æ—Å–ª—É—à–∫–∏

---

**–í–µ—Ä—Å–∏—è:** 5.7.0 (build 33)
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** Android 8.0+ (API 26+)
**–†–∞–∑–º–µ—Ä APK:** ~15 MB

**–°–ª–µ–¥—É—é—â–∏–π —Ä–µ–ª–∏–∑:** v5.8.0 (–Ω–æ—è–±—Ä—å 2025) - –£–ª—É—á—à–µ–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø—Ä–æ—Å–ª—É—à–∫–µ
