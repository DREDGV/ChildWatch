{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Build and Install ChildWatch",
            "type": "shell",
            "command": "gradlew",
            "args": ["assembleDebug"],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "dependsOn": "Install ChildWatch"
        },
        {
            "label": "Install ChildWatch",
            "type": "shell",
            "command": "adb",
            "args": ["install", "-r", "app/build/outputs/apk/debug/app-debug.apk"],
            "group": "build"
        },
        {
            "label": "Launch ChildWatch",
            "type": "shell",
            "command": "adb",
            "args": ["shell", "monkey", "-p", "ru.example.childwatch", "-c", "android.intent.category.LAUNCHER", "1"],
            "group": "build"
        },
        {
            "label": "Quick Test ChildWatch",
            "dependsOrder": "sequence",
            "dependsOn": [
                "Build and Install ChildWatch",
                "Launch ChildWatch"
            ]
        },
        {
            "label": "ðŸ”´ Start Live Mirror (scrcpy)",
            "type": "shell",
            "command": "scrcpy --max-size 1024 --video-bit-rate 2M --always-on-top --window-title 'ChildWatch Live Preview'",
            "isBackground": true,
            "presentation": {
                "reveal": "never",
                "panel": "dedicated"
            },
            "problemMatcher": []
        },
        {
            "label": "âš¡ Quick Install + Restart",
            "type": "shell",
            "command": "adb install -r app/build/outputs/apk/debug/ChildWatch-*.apk; adb shell am force-stop ru.example.childwatch; adb shell monkey -p ru.example.childwatch -c android.intent.category.LAUNCHER 1",
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "focus": false
            },
            "problemMatcher": []
        },
        {
            "label": "ðŸ“¸ Capture Screenshot",
            "type": "shell",
            "command": "$date = Get-Date -Format 'yyyy-MM-dd-HHmmss'; adb exec-out screencap -p > \"screenshot-$date.png\"; Write-Host \"Screenshot saved: screenshot-$date.png\"",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "ðŸ“‹ View Logcat (Filtered)",
            "type": "shell",
            "command": "adb logcat MainActivity:D ChildSelectionActivity:D AudioStreamingActivity:D *:E",
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            },
            "problemMatcher": []
        },
        {
            "label": "ðŸ”„ Restart ADB Server",
            "type": "shell",
            "command": "adb kill-server; Start-Sleep -Seconds 2; adb start-server; adb devices",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "ðŸ“± Start Emulator: Pixel 8 (Child Device)",
            "type": "shell",
            "command": "Start-Process -FilePath 'C:\\Users\\dr-ed\\AppData\\Local\\Android\\Sdk\\emulator\\emulator.exe' -ArgumentList '-avd Pixel_8_API_35'",
            "isBackground": true,
            "problemMatcher": []
        },
        {
            "label": "ðŸ“± Start Emulator: Nokia G21 (Virtual)",
            "type": "shell",
            "command": "Start-Process -FilePath 'C:\\Users\\dr-ed\\AppData\\Local\\Android\\Sdk\\emulator\\emulator.exe' -ArgumentList '-avd Nokia_G21'",
            "isBackground": true,
            "problemMatcher": []
        },
        {
            "label": "ðŸ“± Start Emulator: Medium Phone",
            "type": "shell",
            "command": "Start-Process -FilePath 'C:\\Users\\dr-ed\\AppData\\Local\\Android\\Sdk\\emulator\\emulator.exe' -ArgumentList '-avd Medium_Phone_API_35'",
            "isBackground": true,
            "problemMatcher": []
        },
        {
            "label": "ðŸ”´ Mirror: Pixel 8 Emulator",
            "type": "shell",
            "command": "Start-Sleep -Seconds 10; scrcpy --serial emulator-5554 --max-size 1024 --video-bit-rate 2M --window-title 'ChildWatch (Pixel 8)' --always-on-top",
            "isBackground": true,
            "dependsOn": "ðŸ“± Start Emulator: Pixel 8 (Child Device)",
            "problemMatcher": []
        },
        {
            "label": "ðŸŽ¯ Dual Mirror: Real + Emulator",
            "type": "shell",
            "command": "$realDevice = 'PT19655KA1280800674'; Start-Process scrcpy -ArgumentList \"--serial $realDevice --max-size 1024 --video-bit-rate 2M --window-title 'ParentWatch (Nokia Real)' --window-x 0 --window-y 0\"; Start-Sleep -Seconds 2; Start-Process scrcpy -ArgumentList '--serial emulator-5554 --max-size 1024 --video-bit-rate 2M --window-title ''ChildWatch (Pixel 8)'' --window-x 550 --window-y 0'",
            "isBackground": true,
            "problemMatcher": []
        },
        {
            "label": "ðŸš€ Quick Deploy: ParentWatch to Real Device",
            "type": "shell",
            "command": "adb -s PT19655KA1280800674 install -r parentwatch/build/outputs/apk/debug/ParentWatch-*.apk; if ($?) { adb -s PT19655KA1280800674 shell am force-stop ru.example.parentwatch; adb -s PT19655KA1280800674 shell monkey -p ru.example.parentwatch -c android.intent.category.LAUNCHER 1 }",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "ðŸš€ Quick Deploy: ChildWatch to Emulator",
            "type": "shell",
            "command": "adb -s emulator-5554 install -r app/build/outputs/apk/debug/ChildWatch-*.apk; if ($?) { adb -s emulator-5554 shell am force-stop ru.example.childwatch; adb -s emulator-5554 shell monkey -p ru.example.childwatch -c android.intent.category.LAUNCHER 1 }",
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "ðŸŽ¬ Full Workflow: Build + Deploy Both Apps",
            "dependsOrder": "sequence",
            "dependsOn": [
                "Build and Install ChildWatch",
                "ðŸš€ Quick Deploy: ParentWatch to Real Device",
                "ðŸš€ Quick Deploy: ChildWatch to Emulator"
            ]
        }
    ]
}