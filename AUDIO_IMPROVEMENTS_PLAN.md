# üéôÔ∏è Audio Streaming Improvement Plan

## ‚úÖ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (v3.2.3)
- ‚úÖ Device ID —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Audio streaming –ø–µ—Ä–µ–¥–∞–µ—Ç –∑–≤—É–∫ —Å –¥–µ—Ç—Å–∫–æ–≥–æ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω
- ‚úÖ –°—á–µ—Ç—á–∏–∫ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –¢–∞–π–º–µ—Ä –æ—Ç—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è –ø—Ä–æ—Å–ª—É—à–∫–∏

## ‚ùå –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### 1. üî¥ –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∑–≤—É–∫–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–≤—É–∫ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥, –ø–æ—Ç–æ–º –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–µ–π audio chunks –≤ ChildWatch
**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á–∏—Ç—å –±—É—Ñ–µ—Ä AudioTrack
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å chunks –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- Pre-buffering (–Ω–∞–∫–æ–ø–∏—Ç—å 2-3 chunks –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è)
- Interpolation –ø—Ä–∏ –ø—Ä–æ–ø—É—Å–∫–µ chunks

**–§–∞–π–ª—ã:**
- `app/src/main/java/ru/example/childwatch/AudioStreamingActivity.kt`
- –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ª–æ–≥–∏–∫—É –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å –æ—á–µ—Ä–µ–¥—å—é

---

### 2. üî¥ –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –ü—Ä–æ—Å–ª—É—à–∫–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ —ç–∫—Ä–∞–Ω–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ Activity –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ streaming –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞:** Android –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç Activity –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å `android:configChanges="orientation|screenSize"` –≤ AndroidManifest
- –ò–ª–∏ –≤—ã–Ω–µ—Å—Ç–∏ audio streaming –≤ Service (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ streaming –≤ `onSaveInstanceState()`

**–§–∞–π–ª—ã:**
- `app/src/main/AndroidManifest.xml` - –¥–æ–±–∞–≤–∏—Ç—å configChanges
- `app/src/main/java/ru/example/childwatch/AudioStreamingActivity.kt` - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å rotation

---

### 3. üü° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –®—É–º –∏ —à–∏–ø–µ–Ω–∏–µ –Ω–∞ —Ñ–æ–Ω–µ
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–æ —Ñ–æ–Ω–æ–≤–æ–≥–æ —à—É–º–∞ –∏ —à–∏–ø–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ—Å–ª—É—à–∫–∏
**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ—Ç —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏—è
- PCM —Ñ–æ—Ä–º–∞—Ç –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –í–æ–∑–º–æ–∂–Ω–æ –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –Ω–∞ –¥–µ—Ç—Å–∫–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ

**–†–µ—à–µ–Ω–∏–µ:**
- Noise Gate (–æ—Ç—Å–µ–∫–∞—Ç—å —Ç–∏—Ö–∏–µ –∑–≤—É–∫–∏ –Ω–∏–∂–µ threshold)
- Low-pass filter (—É–±—Ä–∞—Ç—å –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π —à—É–º)
- AGC (Automatic Gain Control) –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
- –í–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `AcousticEchoCanceler` –∏ `NoiseSuppressor` –∏–∑ Android API

**–§–∞–π–ª—ã:**
- `parentwatch/src/main/java/ru/example/parentwatch/audio/AudioStreamRecorder.kt`
- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å `AudioProcessor.kt` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

## üü¢ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (—Å—Ä–µ–¥–Ω–∏–π/–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### 4. –†–µ–∂–∏–º—ã –ø—Ä–æ—Å–ª—É—à–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
**–§—É–Ω–∫—Ü–∏–∏:**
- **–ì—Ä–æ–º–∫–æ—Å—Ç—å:** –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É—Å–∏–ª–µ–Ω–∏—è –∑–≤—É–∫–∞ (1x, 2x, 3x)
- **–ö–∞—á–µ—Å—Ç–≤–æ:**
  - –ù–∏–∑–∫–æ–µ (22050 Hz, –º–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞)
  - –°—Ä–µ–¥–Ω–µ–µ (44100 Hz, —Ç–µ–∫—É—â–µ–µ)
  - –í—ã—Å–æ–∫–æ–µ (48000 Hz, –ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ)
- **–†–µ–∂–∏–º—ã:**
  - –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
  - –®—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ (noise reduction)
  - –ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º (optimize –¥–ª—è —Ä–µ—á–∏)

**–§–∞–π–ª—ã:**
- `app/src/main/res/layout/activity_audio_streaming.xml` - –¥–æ–±–∞–≤–∏—Ç—å controls
- `app/src/main/java/ru/example/childwatch/AudioStreamingActivity.kt` - UI controls
- `parentwatch/src/main/java/ru/example/parentwatch/audio/AudioStreamRecorder.kt` - quality modes

---

### 5. –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä / –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–≤–Ω—è –∑–≤—É–∫–∞
**–§—É–Ω–∫—Ü–∏–∏:**
- Real-time waveform (–≤–æ–ª–Ω–∞ –∑–≤—É–∫–∞)
- Volume meter (–ø–æ–ª–æ—Å–∫–∞ —É—Ä–æ–≤–Ω—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏)
- Frequency bars (—ç–∫–≤–∞–ª–∞–π–∑–µ—Ä –∫–∞–∫ –≤ –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –ø–ª–µ–µ—Ä–∞—Ö)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å "–¢–∏—à–∏–Ω–∞" –∫–æ–≥–¥–∞ –Ω–µ—Ç –∑–≤—É–∫–∞

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:**
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å amplitude audio chunks
- Canvas/Custom View –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
- –û–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–µ 100-200ms

**–§–∞–π–ª—ã:**
- –°–æ–∑–¥–∞—Ç—å `app/src/main/java/ru/example/childwatch/ui/AudioVisualizer.kt`
- –û–±–Ω–æ–≤–∏—Ç—å layout `activity_audio_streaming.xml`

---

### 6. –§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏ –ø—Ä–æ—Å–ª—É—à–∫–∏
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –¢–æ–ª—å–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "–ó–∞–ø–∏—Å—ã–≤–∞—Ç—å –∞—É–¥–∏–æ" (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:**
- ‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "üî¥ –ó–∞–ø–∏—Å—å –Ω–∞—á–∞—Ç–∞"
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä REC –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø—Ä–æ—Å–ª—É—à–∫–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ audio chunks –≤ —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ Endpoint –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- ‚úÖ –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –≤ ChildWatch
- ‚úÖ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

**–§–∞–π–ª—ã:**
- `server/routes/streaming.js` - endpoint –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è recording
- `server/routes/recordings.js` - NEW: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏
- `app/src/main/java/ru/example/childwatch/RecordingsActivity.kt` - NEW: —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π

---

### 7. –¢–∞–π–º–µ—Ä –∞–≤—Ç–æ-–æ—Å—Ç–∞–Ω–æ–≤–∫–∏
**–§—É–Ω–∫—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–æ—Å–ª—É—à–∫—É —á–µ—Ä–µ–∑ N –º–∏–Ω—É—Ç

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 30 –º–∏–Ω—É—Ç
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –≤—Ä–µ–º—è: 10, 20, 30, 60 –º–∏–Ω—É—Ç
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞ 1 –º–∏–Ω—É—Ç—É –¥–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: "‚ö†Ô∏è –ü—Ä–æ—Å–ª—É—à–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É"

**–§–∞–π–ª—ã:**
- `app/src/main/java/ru/example/childwatch/AudioStreamingActivity.kt`
- Settings –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–µ–º–µ–Ω–∏

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)
1. **–§–∏–∫—Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∑–≤—É–∫–∞** (buffering queue) - –°–ï–ô–ß–ê–°
2. **–§–∏–∫—Å –ø–æ–≤–æ—Ä–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞** (configChanges) - –°–ï–ô–ß–ê–°
3. **–ë–∞–∑–æ–≤–æ–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ** (noise gate) - –°–õ–ï–î–£–Æ–©–ò–ô

### –≠—Ç–∞–ø 2: –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ (–±–ª–∏–∂–∞–π—à–∏–µ –≤–µ—Ä—Å–∏–∏)
4. **–†–µ–∂–∏–º—ã –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –≥—Ä–æ–º–∫–æ—Å—Ç—å** (v3.3.0)
5. **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–≤—É–∫–∞** (v3.3.0)
6. **–¢–∞–π–º–µ—Ä –∞–≤—Ç–æ-–æ—Å—Ç–∞–Ω–æ–≤–∫–∏** (v3.3.0)

### –≠—Ç–∞–ø 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–±—É–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏)
7. **–§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏** (v3.4.0)
8. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∞—É–¥–∏–æ —Ñ–∏–ª—å—Ç—Ä—ã** (v3.5.0)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ—à–µ–Ω–∏–π

### –†–µ—à–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∑–≤—É–∫–∞ (buffering queue)

**–ü—Ä–æ–±–ª–µ–º–∞:** ChildWatch –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç chunks –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã, –Ω–æ AudioTrack –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –±—ã—Å—Ç—Ä–µ–µ

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—É–ø—Ä–æ—â–µ–Ω–Ω–æ):**
```kotlin
// –ó–∞–ø—Ä–æ—Å chunks –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
while (streaming) {
    val chunks = getChunks()
    for (chunk in chunks) {
        audioTrack.write(chunk) // –ò–≥—Ä–∞–µ—Ç —Å—Ä–∞–∑—É
    }
    delay(2000) // –ñ–¥–µ—Ç 2 —Å–µ–∫—É–Ω–¥—ã
    // –í–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è AudioTrack –∑–∞–∫–æ–Ω—á–∏–ª –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ -> —Ç–∏—à–∏–Ω–∞
}
```

**–†–µ—à–µ–Ω–∏–µ - –æ—á–µ—Ä–µ–¥—å —Å pre-buffering:**
```kotlin
val chunkQueue = ConcurrentLinkedQueue<ByteArray>()
var isBuffering = true

// –ü–æ—Ç–æ–∫ 1: –ó–∞–≥—Ä—É–∑–∫–∞ chunks
launch {
    while (streaming) {
        val chunks = getChunks()
        chunkQueue.addAll(chunks)

        // –ù–∞—á–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Å–ª–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è 3 chunks
        if (isBuffering && chunkQueue.size >= 3) {
            isBuffering = false
        }

        delay(2000)
    }
}

// –ü–æ—Ç–æ–∫ 2: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ chunks
launch {
    while (streaming) {
        if (!isBuffering && chunkQueue.isNotEmpty()) {
            val chunk = chunkQueue.poll()
            audioTrack.write(chunk, 0, chunk.size, AudioTrack.WRITE_BLOCKING)
        } else {
            delay(100) // –ü—Ä–æ–≤–µ—Ä—è—Ç—å –æ—á–µ—Ä–µ–¥—å –∫–∞–∂–¥—ã–µ 100ms
        }
    }
}
```

---

### –†–µ—à–µ–Ω–∏–µ –ø–æ–≤–æ—Ä–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è Activity**
```xml
<!-- AndroidManifest.xml -->
<activity
    android:name=".AudioStreamingActivity"
    android:configChanges="orientation|screenSize|keyboardHidden"
    android:screenOrientation="portrait">
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –í—ã–Ω–µ—Å—Ç–∏ streaming –≤ Service (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ)**
```kotlin
class AudioStreamingService : Service() {
    private val audioPlayer = AudioPlayer()

    override fun onStartCommand(intent: Intent, flags: Int, startId: Int): Int {
        val deviceId = intent.getStringExtra("deviceId")
        audioPlayer.startStreaming(deviceId)
        return START_STICKY // Restart if killed
    }
}
```

---

### –®—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ - Noise Gate

**–ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```kotlin
fun applyNoiseGate(audioData: ByteArray, threshold: Short = 500): ByteArray {
    val samples = audioData.toShortArray()

    for (i in samples.indices) {
        // –ï—Å–ª–∏ –∞–º–ø–ª–∏—Ç—É–¥–∞ –Ω–∏–∂–µ threshold - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ç–∏—à–∏–Ω—É
        if (abs(samples[i]) < threshold) {
            samples[i] = 0
        }
    }

    return samples.toByteArray()
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ AudioStreamRecorder
private fun recordChunk(): ByteArray? {
    val rawAudio = audioRecord.read(buffer, ...)
    val filtered = applyNoiseGate(rawAudio, threshold = 500)
    return filtered
}
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–ï–ô–ß–ê–°**: –§–∏–∫—Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∑–≤—É–∫–∞ (buffering queue)
2. **–°–ï–ô–ß–ê–°**: –§–∏–∫—Å –ø–æ–≤–æ—Ä–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞ (configChanges)
3. **–°–õ–ï–î–£–Æ–©–ò–ô**: –ë–∞–∑–æ–≤–æ–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ
4. **–ü–û–¢–û–ú**: –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ –ø–ª–∞–Ω—É

---

## üì¶ –í–µ—Ä—Å–∏–∏

- **v3.2.3** (—Ç–µ–∫—É—â–∞—è) - Audio streaming —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏
- **v3.3.0** (planned) - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∑–≤—É–∫–∞ + –±–∞–∑–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- **v3.4.0** (planned) - –§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏
- **v3.5.0** (planned) - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∞—É–¥–∏–æ —Ñ–∏–ª—å—Ç—Ä—ã

---

–≠—Ç–æ—Ç –ø–ª–∞–Ω –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π.
